SELECT CSD.ROWID,
       CSD.COLA_BRID,
       CSD.COLA_CONT_REFF,
       CSD.COLA_ID_SYSTEM,
       CSD.COLA_ID_FISIK,
       CMD.COLA_STATUS,
       CSD.COLA_ROOM_CODE,
       CMD.COLA_DESC_35,
       TO_DATE(CSH.COLA_INSERT_DATE - 1) COLA_INSERT_DATE,
       TO_DATE(CMH.COLA_SYSDATE) COLA_SYSDATE,
       CASE
         WHEN (TO_DATE(CSH.COLA_INSERT_DATE - 1) > TO_DATE(CMH.COLA_SYSDATE) AND
              CMD.COLA_STATUS = 'RLT') OR
              (TO_DATE(CSH.COLA_INSERT_DATE - 1) < TO_DATE(CMH.COLA_SYSDATE)) THEN
          'COLA_ID_FISIK = COLA_ID_SYSTEM (NULL)'
         ELSE
          'COLA_ID_FISIK = COLA_ID_SYSTEM'
       END ACCTION,
       CASE
         WHEN CSD.COLA_ID_SYSTEM IS NULL THEN
          'LEBIH'
         ELSE
          'KURANG'
       END SELISIH
  FROM AD1CMS.COLA_STOCKOPNAME_DETAIL CSD
  JOIN AD1CMS.COLA_STOCKOPNAME_HEADER CSH
    ON CSH.COLA_MEMO_NO = CSD.COLA_MEMO_NO
  JOIN AD1CMS.COLA_MASTER_HISTORY CMH
    ON CMH.COLA_ID = CSD.COLA_ID_SYSTEM
    OR CMH.COLA_ID = CSD.COLA_ID_FISIK
  JOIN AD1CMS.COLA_MASTER_DATA CMD
    ON CMD.COLA_ID = CSD.COLA_ID_SYSTEM
    OR CMD.COLA_ID = CSD.COLA_ID_FISIK
 WHERE CSD.COLA_MEMO_NO = '07372401N0000000010'
   AND ((CSD.COLA_ID_FISIK IS NULL AND CSD.COLA_ID_SYSTEM IS NOT NULL) OR
       (CSD.COLA_ID_FISIK IS NOT NULL AND CSD.COLA_ID_SYSTEM IS NULL))
   AND CMH.COLA_SEQNO = (SELECT MAX(B.COLA_SEQNO)
                           FROM AD1CMS.COLA_MASTER_HISTORY B
                          WHERE B.COLA_ID = CMH.COLA_ID);